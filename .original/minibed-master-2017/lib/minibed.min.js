!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Minibed",[],t):"object"==typeof exports?exports.Minibed=t():e.Minibed=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t,n){"use strict";function i(e){var t=this,n=e.split(".");return e=n.shift(),this.el=document.createElement(e),n.forEach(function(e){d(t.el,e)}),this.class=function(e){return d(t.el,e),t},this.setAttr=function(e,n){return t.el.setAttribute(e,n),t},this.html=function(e){return t.el.innerHTML=e,t},this.dom=function(){return t.el},this.append=function(e){return t.el.appendChild(e),t},this}function r(e,t,n){var i=void 0;if(!n){for(i in t)if(t.hasOwnProperty(i)&&t[i]===e)return!0}else for(i in t)if(t.hasOwnProperty(i)&&t[i]===e)return!0;return!1}function s(e){e=e||window.event,void 0!==e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="minibed_"+e+"_";return t+="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function a(e){var t=e.offsetHeight,n=window.getComputedStyle(e);return t+=parseInt(n.marginTop)+parseInt(n.marginBottom)}function l(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t=t.split(" ");for(var r=0;r<t.length;r++)document.addEventListener?e.addEventListener(t[r],n,i):document.attachEvent&&e.attachEvent("on"+t[r],n)}function c(e,t){return("string"==typeof e?e:h(e)).indexOf(" "+t+" ")>=0}function d(e,t){var n=h(e),i=n+t;c(n,t)||(e.className=i.substring(1))}function u(e,t){var n=h(e),i=void 0;c(e,t)&&(i=n.replace(" "+t+" "," "),e.className=i.substring(1,i.length-1))}function p(e){e.parentNode&&e.parentNode.removeChild(e)}function h(e){return(" "+(e&&e.className||"")+" ").replace(/\s+/gi," ")}function f(e){return e.match(/\.([^.]+)$/)[1]}function m(e){var t=document.createElement("div");return t.innerHTML=e,t.innerHTML}function v(){return"ontouchstart"in window||navigator.maxTouchPoints}function b(e){function t(e){e.preventDefault();try{e=e.touches[0]?e.touches[0]:e}catch(e){}c.startX=e.clientX,c.startY=e.clientY,c.startWidth=parseInt(document.defaultView.getComputedStyle(c.el,null).width,10),c.startHeight=parseInt(document.defaultView.getComputedStyle(c.el,null).height,10),l(window,"mousemove",s,!1),l(window,"mouseup",o,!1),l(window,"touchmove",n,!1),l(window,"touchend",r,!1)}function n(e){s(e.touches[0])}function r(e){0===e.touches.length&&o(e.changedTouches[0])}function s(e){c.el.style.height=c.startHeight+e.clientY-c.startY+"px",a()}function o(){window.removeEventListener("mousemove",s,!1),window.removeEventListener("mouseup",o,!1),window.removeEventListener("touchmove",n,!1),window.removeEventListener("touchend",r,!1)}var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},c=this;this.el=e;var d=new i("div.resizable-handle").el;e.appendChild(d),l(d,"mousedown",t,!1),l(d,"touchstart",t,!1)}Object.defineProperty(t,"__esModule",{value:!0});var _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.CreateDOM=i,t.inArray=r,t.stopPropagation=s,t.generateID=o,t.outerHeight=a,t.addListener=l,t.hasClass=c,t.addClass=d,t.removeClass=u,t.remove=p,t.classList=h,t.getExtension=f,t.fixHTML=m,t.isTouchDevice=v,t.MBResizable=b;t.animationEndEvents="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",t.deepExtend=function e(t){t=t||{};for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)i.hasOwnProperty(r)&&(Array.isArray(i[r])?t[r]=i[r]:"object"===_(i[r])&&null!==i[r]?t[r]=e(t[r],i[r]):t[r]=i[r])}return t},t.css=function(){function e(e){return e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(e,t){return t.toUpperCase()})}function t(e){var t=document.body.style;if(e in t)return e;for(var n=r.length,i=e.charAt(0).toUpperCase()+e.slice(1),s=void 0;n--;)if((s=r[n]+i)in t)return s;return e}function n(n){return n=e(n),s[n]||(s[n]=t(n))}function i(e,t,i){t=n(t),e.style[t]=i}var r=["Webkit","O","Moz","ms"],s={};return function(e,t){var n=arguments,r=void 0,s=void 0;if(2===n.length)for(r in t)t.hasOwnProperty(r)&&void 0!==(s=t[r])&&t.hasOwnProperty(r)&&i(e,r,s);else i(e,n[1],n[2])}}(),t.Request=function(e,t,n){var i=new window.XMLHttpRequest;if("withCredentials"in i)i.onreadystatechange=function(){4===i.readyState&&(200===i.status||304===i.status?t(i.responseText):setTimeout(n,0))},i.open("GET",e,!0),i.send();else{var r=new window.XDomainRequest;r.onerror=function(){setTimeout(n,0)},r.ontimeout=function(){setTimeout(n,0)},r.onload=function(){t(r.responseText)},r.open("get",e),r.send()}}},function(e,t,n){"use strict";function i(e){c(e),e.wrapper=document.createElement("div"),e.wrapper.setAttribute("id",e.id),u.addClass(e.wrapper,"minibed_bed minibed_theme__"+e.options.theme),e.options.notes.length>0&&u.addClass(e.wrapper,"minibed_has_footer"),s(e),a(e),l(e)}function r(e,t){var n=p[e.options.settings[t].preprocessor];return void 0===n?"js"===t?"JavaScript":"css"===t?"CSS":"HTML":n}function s(e){var t=new u.CreateDOM("div.minibed_tabs"),n=!1,i=new u.CreateDOM("a.minibed_logo").setAttr("href","http://ned.im/minibed").html("minibed");if(t.append(i.el),e.has.html){var s=new u.CreateDOM("div.minibed_tab.minibed_tabs_html");s.setAttr("data-lang","htmlmixed"),s.setAttr("data-multiple",e.options.files.html.length>1),n||(s.class("minibed_active"),n=!0);var a=new u.CreateDOM("div.minibed_tabs_current").setAttr("data-current",e.options.files.html[0]).html(r(e,"html"));if(s.append(a.el),e.options.files.html.length>1){var l=new u.CreateDOM("div.minibed_tabs_dropdown"),c=0;e.options.files.html.forEach(function(e){var t=new u.CreateDOM("div.minibed_dropdown_item").html(o(e)).setAttr("data-file",e);0===c&&t.class("minibed_selected_tab"),l.append(t.el),c++}),s.append(l.el)}t.append(s.el)}if(e.has.css){var d=new u.CreateDOM("div.minibed_tab.minibed_tabs_css");d.setAttr("data-lang","css"),d.setAttr("data-multiple",e.options.files.css.length>1),n||(d.class("minibed_active"),n=!0);var p=new u.CreateDOM("div.minibed_tabs_current").setAttr("data-current",e.options.files.css[0]).html(r(e,"css"));if(d.append(p.el),e.options.files.css.length>1){var h=new u.CreateDOM("div.minibed_tabs_dropdown"),f=0;e.options.files.css.forEach(function(e){var t=new u.CreateDOM("div.minibed_dropdown_item").html(o(e)).setAttr("data-file",e);0===f&&t.class("minibed_selected_tab"),h.append(t.el),f++}),d.append(h.el)}t.append(d.el)}if(e.has.js){var m=new u.CreateDOM("div.minibed_tab.minibed_tabs_js");m.setAttr("data-lang","javascript"),m.setAttr("data-multiple",e.options.files.js.length>1),n||m.class("minibed_active");var v=new u.CreateDOM("div.minibed_tabs_current").setAttr("data-current",e.options.files.js[0]).html(r(e,"js"));if(m.append(v.el),e.options.files.js.length>1){var b=new u.CreateDOM("div.minibed_tabs_dropdown"),_=0;e.options.files.js.forEach(function(e){var t=new u.CreateDOM("div.minibed_dropdown_item").html(o(e)).setAttr("data-file",e);0===_&&t.class("minibed_selected_tab"),b.append(t.el),_++}),m.append(b.el)}t.append(m.el)}var y=new u.CreateDOM("div.minibed_tab_result").html('<div class="minibed_checkbox-result"><input type="checkbox" id="minibed_checkbox-result" value="on"><label for="minibed_checkbox-result"></label> Live </div>');t.append(y.el),e.wrapper.appendChild(t.el)}function o(e){var t=e.split("/");return t[t.length-1]}function a(e){var t=new u.CreateDOM("div.minibed_tab_contents"),n=!1;if(e.loading=new u.CreateDOM("div.minibed_loading"),t.append(e.loading.el),e.has.html){var i=0;e.options.files.html.forEach(function(e){var r=new u.CreateDOM("textarea.minibed_tab_content").setAttr("data-file",e).setAttr("data-loaded","no").setAttr("data-lang","htmlmixed");0===i&&r.class("minibed_selected_content"),n||(r.class("minibed_active_tab"),n=!0),t.append(r.el),i++})}if(e.has.css){var r=0;e.options.files.css.forEach(function(e){var i=new u.CreateDOM("textarea.minibed_tab_content").setAttr("data-file",e).setAttr("data-loaded","no").setAttr("data-lang","css");0===r&&i.class("minibed_selected_content"),n||(i.class("minibed_active_tab"),n=!0),t.append(i.el),r++})}if(e.has.js){var s=0;e.options.files.js.forEach(function(e){var i=new u.CreateDOM("textarea.minibed_tab_content").setAttr("data-file",e).setAttr("data-loaded","no").setAttr("data-lang","javascript");0===s&&i.class("minibed_selected_content"),n||(i.class("minibed_active_tab"),n=!0),t.append(i.el),s++})}var o=new u.CreateDOM("iframe.minibed_result_frame").setAttr("src","about:blank").setAttr("name",e.id);t.append(o.el),e.wrapper.appendChild(t.el)}function l(e){if(e.options.notes.length>0){var t=new u.CreateDOM("div.minibed_footer");e.options.notes.forEach(function(e){var n=new u.CreateDOM("p.minibed_footer_note").html(e);t.append(n.el)}),e.wrapper.appendChild(t.el)}}function c(e){e.options.container&&(e.container=document.querySelector(e.options.container))}Object.defineProperty(t,"__esModule",{value:!0}),t.Defaults=t.Includes=t.FileTypes=void 0,t.build=i;var d=n(0),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(d),p=(t.FileTypes={html:["html"],css:["css","sass","scss","less"],js:["js","es6"]},t.Includes={normalize:"https://cdnjs.cloudflare.com/ajax/libs/normalize/6.0.0/normalize.min.css",reset:"https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css"},t.Defaults={theme:"dark",editorTheme:"minibed-dark",id:!1,container:!1,files:{html:[],js:[],css:[]},external:{js:[],css:[]},settings:{readOnly:!1,scrollLock:!1,lineWrapping:!0,lineNumbers:!0,tabSize:2,js:{preprocessor:"none"},css:{preprocessor:"none",base:"normalize",prefixing:"none",imports:[]},html:{preprocessor:"none"}}},{sass:"SASS",scss:"SCSS",less:"LESS",stylus:"Stylus",babel:"Babel",coffeescript:"CoffeeScript",livescript:"LiveScript",typescript:"TypeScript",haml:"Haml",slim:"Slim",pug:"Pug"})},function(e,t){},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();n(2);var o=n(1),a=i(o),l=n(0),c=i(l),d=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(this,e),this.options=c.deepExtend({},a.Defaults,n),this.id=this.options.id||c.generateID("bed"),this.liveTimeout=-1,this.isLive=!1,this.heightSetted=!1,this.resizer=null,this.loading=null,this.wrapper=null,this.container=null,this.liveButton=null,this.has={html:!1,css:!1,js:!1},Object.keys(this.options.files).forEach(function(e){if(t.options.files.hasOwnProperty(e))for(var n=0;n<t.options.files[e].length;n++){var i=c.getExtension(t.options.files[e][n]);c.inArray(i,a.FileTypes.html)?t.has.html=!0:c.inArray(i,a.FileTypes.js)?t.has.js=!0:c.inArray(i,a.FileTypes.css)&&(t.has.css=!0)}}),this}return s(e,[{key:"show",value:function(){return a.build(this),this.container.appendChild(this.wrapper),this.loading=this.container.querySelector(".minibed_loading"),this.bindEvents(),this.initEditor(),this}},{key:"bindEvents",value:function(){var e=this,t=this;this.wrapper.querySelectorAll(".minibed_tab").forEach(function(e){c.addListener(e,"click",function(n){c.stopPropagation(n),c.hasClass(e,"minibed_active")||(c.removeClass(t.wrapper.querySelector(".minibed_active"),"minibed_active"),c.addClass(e,"minibed_active")),c.removeClass(t.wrapper.querySelector(".minibed_active_tab"),"minibed_active_tab"),c.removeClass(t.wrapper.querySelector('.minibed_tab_content[data-lang="'+e.getAttribute("data-lang")+'"]'),"minibed_selected_content"),c.addClass(t.wrapper.querySelector('.minibed_tab_content[data-file="'+e.querySelector(".minibed_tabs_current").getAttribute("data-current")+'"]'),"minibed_active_tab minibed_selected_content"),t.initEditor()})}),this.liveButton=this.wrapper.querySelector(".minibed_tab_result"),c.addListener(this.liveButton,"click",function(){e.liveToggle()}),c.addListener(this.liveButton.querySelector("label"),"click",function(e){return e.preventDefault(),!1}),this.wrapper.querySelectorAll(".minibed_dropdown_item").forEach(function(e){c.addListener(e,"click",function(t){if(c.stopPropagation(t),!c.hasClass(e,"minibed_selected_tab")){c.removeClass(e.parentNode.querySelector(".minibed_selected_tab"),"minibed_selected_tab"),c.addClass(e,"minibed_selected_tab");var n=e.parentNode.parentNode.querySelector(".minibed_tabs_current");n.setAttribute("data-current",e.getAttribute("data-file")),n.click()}})})}},{key:"liveToggle",value:function(){var e=this;c.hasClass(this.liveButton,"mb_live_active")?(c.removeClass(this.liveButton,"mb_live_active"),c.removeClass(this.tabContents,"minibed_live"),this.liveButton.querySelector("#minibed_checkbox-result").removeAttribute("checked"),this.isLive=!1):(c.addClass(this.liveButton,"mb_live_active"),c.addClass(this.tabContents,"minibed_live"),this.liveButton.querySelector("#minibed_checkbox-result").setAttribute("checked","checked"),this.isLive=!0,this.run()),setTimeout(function(){e.activeEditor.refresh()},10)}},{key:"importCSS",value:function(){var e=this.container.querySelector('.minibed_selected_content[data-lang="css"]');return e?'<style type="text/css">'+e.innerHTML+"</style>":""}},{key:"importHTML",value:function(){var e=this.container.querySelector('.minibed_selected_content[data-lang="htmlmixed"]');return e?c.fixHTML(e.value):""}},{key:"importJS",value:function(){var e=this.container.querySelector('.minibed_selected_content[data-lang="javascript"]');return e?'<script type="text/javascript">'+e.value+"<\/script>":""}},{key:"importJSError",value:function(){return'<script type="text/javascript">window.onerror = function(msg, source, lineno, colno, error) {\n      console.log(msg, source, lineno, colno, error)\n      parent.document.querySelector(\'.minibed_bed#'+this.id+" .minibed_result_frame').style.borderBottomColor = '#F44336';\n    }<\/script>"}},{key:"importBaseCSS",value:function(){return"none"!==this.options.settings.css.base?'<link rel="stylesheet prefetch" href="'+a.Includes[this.options.settings.css.base]+'"/>':""}},{key:"importExternalCSS",value:function(){var e="";return this.options.external.css.length>0&&this.options.external.css.forEach(function(t){e+='<link rel="stylesheet prefetch" href="'+t+'"/>'}),e}},{key:"importExternalJS",value:function(){var e="";return this.options.external.js.length>0&&this.options.external.js.forEach(function(t){e+='<script src="'+t+'" type="text/javascript"><\/script>\n\n\n'}),e}},{key:"run",value:function(){if(this.isLive){c.remove(this.container.querySelector("iframe.minibed_result_frame"));var e=new c.CreateDOM("iframe.minibed_result_frame").setAttr("src","about:blank").setAttr("name",this.id);this.tabContents.appendChild(e.el);var t='<!DOCTYPE html>\n        <html lang="en">\n        <head>\n          <meta charset="UTF-8">\n          <title>minibed <3</title>\n          '+this.importBaseCSS()+"\n          "+this.importExternalCSS()+"\n          "+this.importCSS()+"\n        </head>\n        <body>\n          "+this.importHTML()+"\n          "+this.importJSError()+"\n          "+this.importExternalJS()+"\n          "+this.importJS()+"\n        </body>\n        </html>",n=window.frames[this.id].document;n.open(),n.write(t),n.close()}}},{key:"initCodeMirror",value:function(){var e=this,t=this.activeContent.getAttribute("data-lang");this.activeEditor=CodeMirror.fromTextArea(this.activeContent,{mode:t,tabSize:this.options.settings.tabSize,lineNumbers:this.options.settings.lineNumbers,lineWrapping:this.options.settings.lineWrapping,readOnly:this.options.settings.readOnly,styleActiveLine:!0,matchBrackets:!0,autoCloseBrackets:!0,autoCloseTags:!0,theme:this.options.editorTheme,scrollbarStyle:"simple"}),this.activeEditor.on("change",function(){e.activeContent.innerHTML=e.activeEditor.getValue(),e.activeContent.value=e.activeEditor.getValue(),clearTimeout(e.liveTimeout),e.liveTimeout=setTimeout(function(){e.run()},400)}),this.tabContents=this.wrapper.querySelector(".minibed_tab_contents"),e.heightSetted||c.css(this.tabContents,{height:this.tabContents.offsetHeight+"px"});var n=this.wrapper.querySelector(".CodeMirror-scroll");this.options.settings.scrollLock&&!c.isTouchDevice()&&c.addListener(n,"mousewheel DOMMouseScroll",function(e){var t=e.wheelDelta||e.originalEvent&&e.originalEvent.wheelDelta||-e.detail,i=n.scrollTop+n.getBoundingClientRect().height-n.scrollHeight>=0,r=n.scrollTop<=0;(t<0&&i||t>0&&r)&&e.preventDefault()}),c.addClass(this.loading,"hide"),this.resizer=new c.MBResizable(this.wrapper.querySelector(".CodeMirror"),function(){e.activeEditor.refresh(),c.css(e.tabContents,{height:e.wrapper.querySelector(".CodeMirror").offsetHeight+"px"})}),this.run()}},{key:"initEditor",value:function(){var e=this;if(c.removeClass(this.loading,"hide"),this.activeEditor&&this.activeEditor.toTextArea(),this.activeContent=this.container.querySelector(".minibed_active_tab"),"yes"===this.activeContent.getAttribute("data-loaded"))return void this.initCodeMirror();var t=[];this.has.js&&this.options.files.js.forEach(function(e){t.push(e)}),this.has.css&&this.options.files.css.forEach(function(e){t.push(e)}),this.has.html&&this.options.files.html.forEach(function(e){t.push(e)}),this.responseCount=0,t.forEach(function(t){c.Request(t,function(n){e.responseCount++;var i=e.wrapper.querySelector('.minibed_tab_content[data-file="'+t+'"]');i.innerHTML=n,i.setAttribute("data-loaded","yes")})}),this.responseCheck=window.setInterval(function(){e.responseCount===t.length&&(window.clearInterval(e.responseCheck),e.initCodeMirror(),e.liveToggle())},100)}}],[{key:"overrideDefaults",value:function(e){return a.Defaults=c.deepExtend({},a.Defaults,e),this}},{key:"version",value:function(){return"0.0.2-beta"}}]),e}();t.default=d,e.exports=t.default}])});
//# sourceMappingURL=minibed.min.js.map